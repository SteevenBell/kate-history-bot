–û—Ç–ª–∏—á–Ω–æ! üéØ  
–Ø –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª **–ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã**, **–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—é** –∏ **SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü**, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏ —Ä–∞–Ω–µ–µ.

–≠—Ç–æ –±—É–¥–µ—Ç —Ç–≤–æ–π **–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–∞–π–¥ –ø–æ –ë–î**:
- –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- SQL-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ–ª—è–º
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∏–º –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

# üóÉÔ∏è –¢–∞–±–ª–∏—Ü—ã –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏–µ

## 1. `users` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram-–±–æ—Ç–∞

### –û–ø–∏—Å–∞–Ω–∏–µ:
–•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –±–æ—Ç–æ–º.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `telegram_id` | BIGINT UNIQUE NOT NULL | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram |
| `first_name` | VARCHAR(255) | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram |
| `username` | VARCHAR(255) | –õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å) |
| `role` | ENUM('user', 'admin') | –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ |
| `updated_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS users (
    id BIGSERIAL PRIMARY KEY,
    telegram_id BIGINT UNIQUE NOT NULL,
    first_name VARCHAR(255),
    username VARCHAR(255),
    role VARCHAR(50) DEFAULT 'user',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 2. `courses` ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã

### –û–ø–∏—Å–∞–Ω–∏–µ:
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫—É—Ä—Å–∞—Ö: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ü–µ–Ω–∞, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫—É—Ä—Å–∞ |
| `title` | VARCHAR(255) NOT NULL | –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ |
| `description` | TEXT | –û–ø–∏—Å–∞–Ω–∏–µ –∫—É—Ä—Å–∞ |
| `price` | NUMERIC(10,2) | –°—Ç–æ–∏–º–æ—Å—Ç—å –∫—É—Ä—Å–∞ |
| `duration_days` | INTEGER | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ –≤ –¥–Ω—è—Ö |
| `is_published` | BOOLEAN DEFAULT FALSE | –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –ª–∏ –∫—É—Ä—Å |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS courses (
    id BIGSERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    price NUMERIC(10,2),
    duration_days INT,
    is_published BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 3. `course_purchases` ‚Äî –ø–æ–∫—É–ø–∫–∏ –∫—É—Ä—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### –û–ø–∏—Å–∞–Ω–∏–µ:
–§–∏–∫—Å–∏—Ä—É–µ—Ç, –∫—Ç–æ –∫–∞–∫–æ–π –∫—É—Ä—Å –∫—É–ø–∏–ª, –∫–æ–≥–¥–∞, –Ω–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫, –∫–∞–∫–æ–≤–∞ —Å—É–º–º–∞ –æ–ø–ª–∞—Ç—ã.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏ |
| `user_id` | BIGINT REFERENCES users(id) | –ö—Ç–æ –∫—É–ø–∏–ª –∫—É—Ä—Å |
| `course_id` | BIGINT REFERENCES courses(id) | –ö–∞–∫–æ–π –∫—É—Ä—Å –∫—É–ø–ª–µ–Ω |
| `purchase_date` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏ |
| `access_expires_at` | TIMESTAMP | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ |
| `payment_status` | ENUM('pending', 'paid', 'failed') | –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ |
| `amount_paid` | NUMERIC(10,2) | –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—É–º–º–∞ –æ–ø–ª–∞—Ç—ã |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS course_purchases (
    id BIGSERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(id),
    course_id BIGINT REFERENCES courses(id),
    purchase_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    access_expires_at TIMESTAMP,
    payment_status VARCHAR(50) CHECK (payment_status IN ('pending', 'paid', 'failed')),
    amount_paid NUMERIC(10,2),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 4. `tests` ‚Äî —Ç–µ—Å—Ç—ã –ø–æ —Ç–µ–º–∞–º

### –û–ø–∏—Å–∞–Ω–∏–µ:
–¢–µ—Å—Ç—ã –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –æ–±—â–µ—Å—Ç–≤–æ–≤–µ–¥–µ–Ω–∏—é, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –≤ –±–æ—Ç–µ.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ç–µ—Å—Ç–∞ |
| `title` | VARCHAR(255) NOT NULL | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ |
| `subject` | ENUM('history', 'society') | –ü—Ä–µ–¥–º–µ—Ç: –∏—Å—Ç–æ—Ä–∏—è –∏–ª–∏ –æ–±—â–µ—Å—Ç–≤–æ–≤–µ–¥–µ–Ω–∏–µ |
| `description` | TEXT | –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ |
| `is_published` | BOOLEAN DEFAULT FALSE | –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ç–µ—Å—Ç–∞ |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS tests (
    id BIGSERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    subject VARCHAR(50) CHECK (subject IN ('history', 'society')),
    description TEXT,
    is_published BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 5. `test_questions` ‚Äî –≤–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–æ–≤

### –û–ø–∏—Å–∞–Ω–∏–µ:
–í–æ–ø—Ä–æ—Å—ã, –≤—Ö–æ–¥—è—â–∏–µ –≤ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –≤–æ–ø—Ä–æ—Å–∞ |
| `test_id` | BIGINT REFERENCES tests(id) | –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ—Å—Ç |
| `question_text` | TEXT NOT NULL | –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ |
| `question_type` | ENUM('single_choice', 'multiple_choice', 'open_answer') | –¢–∏–ø –≤–æ–ø—Ä–æ—Å–∞ |
| `image_url` | VARCHAR(512) | URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å) |
| `weight` | INT CHECK (1..5) | –í–µ—Å –≤–æ–ø—Ä–æ—Å–∞ (–≤–∫–ª–∞–¥ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç) |
| `order_num` | INT | –ü–æ—Ä—è–¥–æ–∫ –≤–æ–ø—Ä–æ—Å–∞ –≤ —Ç–µ—Å—Ç–µ |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS test_questions (
    id BIGSERIAL PRIMARY KEY,
    test_id BIGINT REFERENCES tests(id),
    question_text TEXT NOT NULL,
    question_type VARCHAR(50) CHECK (question_type IN ('single_choice', 'multiple_choice', 'open_answer')),
    image_url VARCHAR(512),
    weight INT CHECK (weight BETWEEN 1 AND 5),
    order_num INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 6. `test_answers` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã

### –û–ø–∏—Å–∞–Ω–∏–µ:
–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Ç–∏–ø –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ / –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞), –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –æ—Ç–≤–µ—Ç–∞ |
| `question_id` | BIGINT REFERENCES test_questions(id) | –ù–∞ –∫–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –æ—Ç–Ω–æ—Å–∏—Ç—Å—è |
| `answer_type` | ENUM('exact', 'keywords') | –¢–∏–ø –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| `answer_value` | TEXT NOT NULL | –¢–µ–∫—Å—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ |
| `explanation` | TEXT | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ |
| `is_case_sensitive` | BOOLEAN DEFAULT FALSE | –£—á–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä? |
| `is_correct` | BOOLEAN DEFAULT FALSE | –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS test_answers (
    id BIGSERIAL PRIMARY KEY,
    question_id BIGINT REFERENCES test_questions(id),
    answer_type VARCHAR(50) CHECK (answer_type IN ('exact', 'keywords')),
    answer_value TEXT NOT NULL,
    explanation TEXT,
    is_case_sensitive BOOLEAN DEFAULT FALSE,
    is_correct BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 7. `user_answers` ‚Äî –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ç–µ—Å—Ç—ã

### –û–ø–∏—Å–∞–Ω–∏–µ:
–ö–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ –∫–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –∫–∞–∫ –æ—Ç–≤–µ—Ç–∏–ª –∏ —Å–∫–æ–ª—å–∫–æ –±–∞–ª–ª–æ–≤ –ø–æ–ª—É—á–∏–ª.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –æ—Ç–≤–µ—Ç–∞ |
| `user_id` | BIGINT REFERENCES users(id) | –ö—Ç–æ –æ—Ç–≤–µ—á–∞–ª |
| `test_id` | BIGINT REFERENCES tests(id) | –ö–∞–∫–æ–π —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏–ª |
| `question_id` | BIGINT REFERENCES test_questions(id) | –ù–∞ –∫–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –æ—Ç–≤–µ—á–∞–ª |
| `user_text` | TEXT | –û—Ç–≤–µ—Ç, –¥–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º |
| `is_correct` | BOOLEAN | –í–µ—Ä–µ–Ω –ª–∏ –æ—Ç–≤–µ—Ç |
| `points_earned` | INTEGER | –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –±–∞–ª–ª—ã –∑–∞ –≤–æ–ø—Ä–æ—Å |
| `answered_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –ö–æ–≥–¥–∞ –±—ã–ª –¥–∞–Ω –æ—Ç–≤–µ—Ç |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS user_answers (
    id BIGSERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(id),
    test_id BIGINT REFERENCES tests(id),
    question_id BIGINT REFERENCES test_questions(id),
    user_text TEXT,
    is_correct BOOLEAN,
    points_earned INT,
    answered_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 8. `lessons` ‚Äî –∑–∞–Ω—è—Ç–∏—è (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∏ –≥—Ä—É–ø–ø–æ–≤—ã–µ)

### –û–ø–∏—Å–∞–Ω–∏–µ:
–û–ø–∏—Å—ã–≤–∞–µ—Ç —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç–∏–π: –≤—Ä–µ–º—è, —Ç–∏–ø, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–Ω—è—Ç–∏—è |
| `title` | VARCHAR(255) | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è |
| `lesson_type` | ENUM('individual', 'group') | –¢–∏–ø –∑–∞–Ω—è—Ç–∏—è |
| `max_participants` | INT DEFAULT 1 | –ú–∞–∫—Å–∏–º—É–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ |
| `start_time` | TIMESTAMP | –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ |
| `end_time` | TIMESTAMP | –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è |
| `is_available` | BOOLEAN DEFAULT TRUE | –ó–∞–Ω—è—Ç–∏–µ –µ—â—ë –¥–æ—Å—Ç—É–ø–Ω–æ |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS lessons (
    id BIGSERIAL PRIMARY KEY,
    title VARCHAR(255),
    lesson_type VARCHAR(50) CHECK (lesson_type IN ('individual', 'group')),
    max_participants INT DEFAULT 1,
    start_time TIMESTAMP,
    end_time TIMESTAMP,
    is_available BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 9. `lesson_bookings` ‚Äî –∑–∞–ø–∏—Å–∏ –Ω–∞ –∑–∞–Ω—è—Ç–∏—è

### –û–ø–∏—Å–∞–Ω–∏–µ:
–ö—Ç–æ –∑–∞–ø–∏—Å–∞–ª—Å—è –Ω–∞ –∫–∞–∫–æ–µ –∑–∞–Ω—è—Ç–∏–µ –∏ –∫–∞–∫–æ–π —É —ç—Ç–æ–π –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ç—É—Å.

| –ü–æ–ª–µ | –¢–∏–ø | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----|--------------|
| `id` | BIGSERIAL | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏ |
| `user_id` | BIGINT REFERENCES users(id) | –ö—Ç–æ –∑–∞–ø–∏—Å–∞–ª—Å—è |
| `lesson_id` | BIGINT REFERENCES lessons(id) | –ù–∞ –∫–∞–∫–æ–µ –∑–∞–Ω—è—Ç–∏–µ |
| `booking_status` | ENUM('pending', 'confirmed', 'cancelled') | –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏ |
| `booked_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –í—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ |
| `created_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ |

### SQL:

```sql
CREATE TABLE IF NOT EXISTS lesson_bookings (
    id BIGSERIAL PRIMARY KEY,
    user_id BIGINT REFERENCES users(id),
    lesson_id BIGINT REFERENCES lessons(id),
    booking_status VARCHAR(50) CHECK (booking_status IN ('pending', 'confirmed', 'cancelled')),
    booked_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

# üìå –°–≤–æ–¥–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å–≤—è–∑–µ–π

```
users
‚îú‚îÄ‚îÄ course_purchases ‚Üí courses
‚îú‚îÄ‚îÄ test_results ‚Üí tests ‚Üê test_questions
‚îÇ                   ‚Üñ________‚Üë
‚îÇ                            test_answers
‚îî‚îÄ‚îÄ lesson_bookings ‚Üí lessons
```

---

# üß™ –ü—Ä–∏–º–µ—Ä—ã SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

## 1. –í—Å–µ –∫—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∫—É–ø–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

```sql
SELECT c.title, cp.purchase_date, cp.payment_status
FROM course_purchases cp
JOIN courses c ON cp.course_id = c.id
WHERE cp.user_id = 123;
```

## 2. –í—Å–µ —Ç–µ—Å—Ç—ã, –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

```sql
SELECT t.title AS test_title, 
       ua.is_correct, 
       ua.points_earned
FROM user_answers ua
JOIN tests t ON ua.test_id = t.id
WHERE ua.user_id = 123;
```

## 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —Å–≤–æ–±–æ–¥–Ω—ã–µ –º–µ—Å—Ç–∞ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–º –∑–∞–Ω—è—Ç–∏–∏

```sql
SELECT l.title, l.max_participants - COUNT(lb.id) AS free_slots
FROM lessons l
LEFT JOIN lesson_bookings lb ON l.id = lb.lesson_id
WHERE l.lesson_type = 'group'
GROUP BY l.id, l.title, l.max_participants;
```

## 4. –í—Å–µ –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç

```sql
SELECT q.question_text, ua.user_text, a.answer_value, a.explanation
FROM user_answers ua
JOIN test_questions q ON ua.question_id = q.id
JOIN test_answers a ON q.id = a.question_id
WHERE ua.user_id = 123 AND ua.test_id = 1;
```

## 5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ—Å—Ç—É

```sql
SELECT t.title, 
       SUM(ua.points_earned) AS total_score,
       COUNT(*) AS max_score,
       ROUND(SUM(ua.points_earned) * 100.0 / COUNT(*), 2) AS percentage
FROM user_answers ua
JOIN test_questions q ON ua.question_id = q.id
JOIN tests t ON q.test_id = t.id
WHERE ua.user_id = 123
GROUP BY t.title;
```

---

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:

```
src/
‚îî‚îÄ‚îÄ main/
    ‚îî‚îÄ‚îÄ resources/
        ‚îî‚îÄ‚îÄ data.sql
```

–ú–æ–∂–µ—à—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –≤ —Ñ–∞–π–ª `data.sql`, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏—Ö –≤ pgAdmin –∏–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```bash
psql -h localhost -p 5555 -U bot_user -d bot_db -f data.sql
```

---

# ‚úÖ –ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏–ª:

| –ß—Ç–æ | –î–ª—è —á–µ–≥–æ |
|------|----------|
| –¢–∞–±–ª–∏—Ü–∞ `users` | –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| –¢–∞–±–ª–∏—Ü–∞ `courses` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—Å–∞—Ö |
| –¢–∞–±–ª–∏—Ü–∞ `course_purchases` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ |
| –¢–∞–±–ª–∏—Ü–∞ `tests` | –¢–µ—Å—Ç—ã –ø–æ —Ç–µ–º–∞–º |
| –¢–∞–±–ª–∏—Ü–∞ `test_questions` | –í–æ–ø—Ä–æ—Å—ã –∫ —Ç–µ—Å—Ç–∞–º |
| –¢–∞–±–ª–∏—Ü–∞ `test_answers` | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã |
| –¢–∞–±–ª–∏—Ü–∞ `user_answers` | –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ |
| –¢–∞–±–ª–∏—Ü–∞ `lessons` | –ó–∞–Ω—è—Ç–∏—è (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∏ –≥—Ä—É–ø–ø–æ–≤—ã–µ) |
| –¢–∞–±–ª–∏—Ü–∞ `lesson_bookings` | –ó–∞–ø–∏—Å—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è |
